# Исправление проблемы с перезаливом базы данных при деплое

## Проблема
При деплое на продакшн перезаливалась локальная база данных из разработки.

## Причины
1. **Дублирование копирования файлов в Dockerfile** - приводило к копированию локальной БД
2. **Отсутствие .dockerignore** - локальная БД попадала в Docker образ
3. **Неправильная конфигурация volumes** - использовались абсолютные пути
4. **Отсутствие проверки существования БД в entrypoint.sh**

## Решение

### 1. Исправлен Dockerfile
- Убрано дублирование команд COPY
- Теперь файлы копируются только один раз

### 2. Добавлен .dockerignore
- Исключена локальная база данных из Docker образа
- Исключены системные и временные файлы

### 3. Улучшен entrypoint.sh
- Добавлена проверка существования БД
- Миграции применяются только при необходимости

### 4. Созданы отдельные конфигурации
- `docker-compose.yml` - для разработки
- `docker-compose.prod.yml` - для продакшна с именованными томами

### 5. Добавлены скрипты деплоя
- `deploy-dev.sh` - для разработки
- `deploy-prod.sh` - для продакшна

## Использование

### Для разработки:
```bash
./deploy-dev.sh
```

### Для продакшна:
```bash
# Установите переменные окружения
export DJANGO_SECRET_KEY="your-secret-key"
export DJANGO_ALLOWED_HOSTS="your-domain.com"

./deploy-prod.sh
```

## Результат
- ✅ Локальная БД больше не попадает в продакшн
- ✅ Данные на продакшне сохраняются между деплоями
- ✅ Четкое разделение между dev и prod окружениями
- ✅ Безопасные скрипты деплоя с проверками
